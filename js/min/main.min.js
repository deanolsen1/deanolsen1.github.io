function SizeMe(e){$("body").height($(window).outerHeight()-40),$("body").width($(window).outerWidth());var t=($("body").width(),$("body").height(),0),n=151,o=49,r=60;$("#map").height($("body").height()-$("#map").offset().top),$("#menu").height($("#map").height()-t),$("#vcr-controls").css("top",$("#map").offset().top+$("#map").height()-o-r+"px"),$("#SubjectiveMarkers").height($("#menu").height()-n),e.invalidateSize()}$(document).ready(function(){function e(e,n,o){var r=[];for(var i in e)r.push('<input type="checkbox" name="SMFilter" value="'+e[i]+'">'+e[i]+"<i> &nbsp; &nbsp;&#40;"+n.SMCount[e[i]]+"&#41;</i></input>");$("#SubjectiveMarkers").html(r.join("<br />")),$("#SubjectiveMarkers").on("click",function(){t(n,o),$(".pause").hide(),$(".play").show(),l(n,o)}),$("#checkAllBtn").click(function(){$("#SubjectiveMarkers :checkbox").each(function(){this.checked=!0}),t(n,o),$(".pause").hide(),$(".play").show(),l(n,o)}),$("#uncheckAllBtn").click(function(){$("#SubjectiveMarkers :checkbox").each(function(){this.checked=!1}),t(n,o)}),$("#resetMapBtn").click(function(){S.setView([48.874,2.358],15)})}function t(e,t){v=[],$("input:checkbox[name=SMFilter]:checked").each(function(){v.push($(this).val())}),$("#checkedNum").html(v.length+" categories are checked"),o(e,t)}function n(e){var t=[],n=[],o=[],r=[],i={};for(var a in e.features){var c=e.features[a].properties;void 0===n[c.Page]&&(t.push(c.Page),n[c.Page]=1),void 0===r[c.SM]&&(o.push(c.SM),r[c.SM]=1),void 0===i[c.SM]?i[c.SM]=1:i[c.SM]+=1}return{SMs:o,pages:t.sort(function(e,t){return e-t}),SMCount:i}}function o(e,t,n){S.hasLayer(f)&&S.removeLayer(f),f=L.geoJson(t,{filter:function(e){return n?e.properties.Page==n?!0:!1:-1!==$.inArray(e.properties.SM,v)?!0:!1},pointToLayer:function(e,t){return L.circle(t,100,{fillColor:r(e.properties.SM),color:"#000000",weight:2,fillOpacity:.3}).on({mouseover:function(){this.openPopup(),this.setStyle({color:"#000000"})},mouseout:function(){this.closePopup(),this.setStyle({color:r(e.properties.SM)})}})}}).addTo(S),i()}function r(e){return"Accidental art object"===e?"rgb(166,206,227)":"Acoustic Image"===e?"rgb(178,223,138)":"Ambiance"===e?"rgb(51,160,44)":"Announcement"===e?"rgb(251,154,153)":"Antiville"===e?"rgb(227,26,28)":"Appearance"===e?"rgb(253,191,111)":"Archive"===e?"rgb(255,127,0)":"Art sacrificed"===e?"rgb(166,206,227)":"Attraction"===e?"rgb(202,178,214)":"Branding"===e?"rgb(106,61,154)":"Cartography"===e?"rgb(255,255,153)":"Confession"===e?"rgb(177,89,40)":"Configuration"===e?"rgb(141,211,199)":"Conflicting sites"===e?"rgb(255,255,179)":"Contact"===e?"rgb(190,186,218)":"Danger"===e?"rgb(251,128,114)":"Did you know?"===e?"rgb(128,177,211)":"Future life"===e?"rgb(253,180,98)":"Implicit information"===e?"rgb(179,222,105)":"Incident"===e?"rgb(252,205,229)":"Incursion into nonfactual world"===e?"rgb(217,217,217)":"Indications Incarnate"===e?"rgb(188,128,189)":"Intervention"===e?"rgb(204,235,197)":"Interzonal comparison"===e?"rgb(255,237,111)":"Intrusion"===e?"rgb(141,211,199)":"Local Figure"===e?"rgb(255,255,179)":"Material Esthetics"===e?"rgb(190,186,218)":"Mental Image"===e?"rgb(251,128,114)":"Methodology"===e?"rgb(253,180,98)":"Negative Zone"===e?"rgb(253,180,98)":"Numerophilia"===e?"rgb(179,222,105)":"Optical Illusion"===e?"rgb(252,205,229)":"Performance"===e?"rgb(217,217,217)":"Positive Zone"===e?"rgb(188,128,189)":"Previous city"===e?"rgb(204,235,197)":"Previous life"===e?"rgb(255,237,111)":"Prize list"===e?"rgb(141,211,199)":"Procedure"===e?"rgb(255,255,179)":"Program"===e?"rgb(190,186,218)":"Project"===e?"rgb(251,128,114)":"Proposition"===e?"rgb(128,177,211)":"Racial Ambiance"===e?"rgb(253,180,98)":"Rebaptism"===e?"rgb(179,222,105)":"Recent acquisition"===e?"rgb(252,205,229)":"Reconversion"===e?"rgb(217,217,217)":"Scene"===e?"rgb(188,128,189)":"Self-reference"===e?"rgb(204,235,197)":"Situational poem"===e?"rgb(255,237,111)":"Social mystery"===e?"rgb(141,211,199)":"Sound art"===e?"rgb(255,255,179)":"Strategy"===e?"rgb(190,186,218)":"Style"===e?"rgb(251,128,114)":"Subtitle"===e?"rgb(128,177,211)":"Synethesia"===e?"rgb(253,180,98)":"Temporary Absorption Activity"===e?"rgb(179,222,105)":"Test"===e?"rgb(252,205,229)":"Theory"===e?"rgb(217,217,217)":"To be blown up"===e?"rgb(188,128,189)":"To be blown up right away"===e?"rgb(204,235,197)":"Trap"===e?"rgb(255,237,111)":"True Zone"===e?"rgb(141,211,199)":"Votive Offering"===e?"rgb(251,128,114)":"#FFEDA0"}function i(){f.eachLayer(function(e){var t=e.feature.properties,n=100,o="<i><b>"+t.SM+"</b></i> <br>"+t.Address+"<br>page "+t.Page;e.setRadius(n),e.bindPopup(o,{offset:new L.Point(0,10)}),e.options.color=r(t.SM),e.options.fillColor=r(t.SM)})}function a(e,t,n){var r=L.control({position:"bottomright"});r.onAdd=function(){var r=L.DomUtil.create("input","range-slider");return L.DomEvent.addListener(r,"mousedown",function(e){L.DomEvent.stopPropagation(e)}),$(r).attr({type:"range",max:e[e.length-1],min:e[0],step:1,width:4,value:String(e[0])}).on("input change",function(){o(t,n,this.value),$(".temporal-legend").text("on Page "+this.value)}),r},r.addTo(S),h(e[0])}function c(n,o){$(".pause").hide(),$(".play").click(function(){$(".pause").show(),$(".play").hide(),S.setView([48.876,2.357],15),clearInterval(m),d=150,u(n,o,d),e(n.SMs,n,o),t()}),$(".pause").click(function(){$(".pause").hide(),$(".play").show(),l(n,o,d)}),$(".step").click(function(){l(),$(".pause").hide(),$(".play").show(),s(n,o)}),$(".back").click(function(){l(),$(".pause").hide(),$(".play").show(),g(n,o)}),$(".back-full").click(function(){l(),$(".pause").hide(),$(".play").show(),b(n,o)}),$(".step-full").click(function(){$(".pause").hide(),$(".play").show(),p(n,o)}),$(".faster").click(function(){d>100?(d-=100,clearInterval(m),u(n,o,d)):d=150}),$(".slower").click(function(){1e3>d?(d+=100,clearInterval(m),u(n,o,d),console.log(d)):d=250})}function u(e,t,n){m=setInterval(function(){s(e,t)},n)}function l(e,t,n){n=0,clearInterval(m)}function g(e,t,n){y>9&&y--,o(e,t,y,n),$("input[type=range]").val(y),$(".temporal-legend").text("on Page "+y)}function s(e,t,n){238>y&&y++,o(e,t,y,n),$("input[type=range]").val(y),$(".temporal-legend").text("on Page "+y)}function p(e,t){y=238,o(e,t,y),$("input[type=range]").val(y),$(".temporal-legend").text("on Page "+y)}function b(e,t){y=9,o(e,t,y),$("input[type=range]").val(y),$(".temporal-legend").text("on Page "+y)}function h(e){var t=L.control({position:"bottomright"});t.onAdd=function(){var e=L.DomUtil.create("output","temporal-legend");return e},t.addTo(S),$(".temporal-legend").text("on Page "+e)}var f,d,m,v=[],y=9;L.mapbox.accessToken="pk.eyJ1IjoiZGVhbm9sc2VuMSIsImEiOiJ1dkxBdm9FIn0.kapau_lUukKIE93Y8I0A9g";var S=L.mapbox.map("map","deanolsen1.l4i434a2",{zoomControl:!1,attributionControl:!1});S.setView([48.874,2.358],15),new L.Control.Zoom({position:"topright"}).addTo(S),$.getJSON("data/Locationsv4.geojson").done(function(r){var i=n(r);o(i,r),a(i.pages,i,r),e(i.SMs,i,r),t(i,r),c(i,r)}).fail(function(){alert("There has been a problem loading the data.")})});